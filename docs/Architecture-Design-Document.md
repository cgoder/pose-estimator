# ğŸ—ï¸ TensorFlow.js å¥èº«å§¿æ€åˆ†æç³»ç»Ÿ - è¯¦ç»†æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è§ˆ

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†åŸºäº TensorFlow.js çš„å¥èº«å§¿æ€åˆ†æç³»ç»Ÿçš„å®Œæ•´æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬æ¨¡å—åˆ’åˆ†ã€æŠ€æœ¯é€‰å‹ã€æ•°æ®æµè®¾è®¡ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ç­‰æ ¸å¿ƒå†…å®¹ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2024å¹´12æœˆ  
**é€‚ç”¨èŒƒå›´**: å¥èº«å§¿æ€åˆ†æã€è¿åŠ¨æ•ˆæœè¯„ä¼°ã€è·‘å§¿åˆ†æç­‰åº”ç”¨åœºæ™¯

---

## ğŸ¯ ç³»ç»Ÿæ€»ä½“æ¶æ„

### æ¶æ„è®¾è®¡åŸåˆ™

1. **é«˜å†…èšã€ä½è€¦åˆ**: æ¨¡å—é—´èŒè´£æ¸…æ™°ï¼Œä¾èµ–å…³ç³»ç®€å•
2. **å¯æ‰©å±•æ€§**: æ”¯æŒæ–°çš„è¾“å…¥æºã€åˆ†æç®—æ³•å’Œæ¸²æŸ“æ–¹å¼
3. **é«˜æ€§èƒ½**: å……åˆ†åˆ©ç”¨ WebGLã€Web Workers ç­‰ç°ä»£ Web æŠ€æœ¯
4. **å®¹é”™æ€§**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§ç­–ç•¥
5. **ç”¨æˆ·ä½“éªŒ**: æµç•…çš„äº¤äº’å’Œå‹å¥½çš„çŠ¶æ€åé¦ˆ

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç•Œé¢å±‚ (UI Layer)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UIManager  â”‚  æ§åˆ¶é¢æ¿  â”‚  çŠ¶æ€æ˜¾ç¤º  â”‚  é”™è¯¯å¤„ç†  â”‚  å¿«æ·é”®     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åº”ç”¨åè°ƒå±‚ (App Layer)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              PoseEstimationApp (ä¸»åº”ç”¨åè°ƒå™¨)                    â”‚
â”‚  â€¢ ç”Ÿå‘½å‘¨æœŸç®¡ç†  â€¢ æ¨¡å—åè°ƒ  â€¢ çŠ¶æ€ç®¡ç†  â€¢ é”™è¯¯æ¢å¤              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ ¸å¿ƒä¸šåŠ¡å±‚ (Core Layer)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®è¾“å…¥æ¨¡å—    â”‚  å§¿æ€æ¨ç†æ¨¡å—    â”‚  åˆ†æè®¡ç®—æ¨¡å—    â”‚  æ¸²æŸ“æ¨¡å—   â”‚
â”‚                â”‚                â”‚                â”‚            â”‚
â”‚ â€¢ CameraManager â”‚ â€¢ PoseEstimator â”‚ â€¢ è¿åŠ¨åˆ†æ      â”‚ â€¢ Canvas   â”‚
â”‚ â€¢ è§†é¢‘æ–‡ä»¶å¤„ç†   â”‚ â€¢ æ¨¡å‹ç®¡ç†      â”‚ â€¢ é‡å¤è®¡æ•°      â”‚ â€¢ WebGL    â”‚
â”‚ â€¢ å›¾åƒå¤„ç†      â”‚ â€¢ æ¨ç†ä¼˜åŒ–      â”‚ â€¢ è´¨é‡è¯„ä¼°      â”‚ â€¢ Worker   â”‚
â”‚ â€¢ åœ¨çº¿æµå¤„ç†    â”‚ â€¢ ç»“æœè¿‡æ»¤      â”‚ â€¢ è·‘å§¿åˆ†æ      â”‚ â€¢ å¯è§†åŒ–   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åŸºç¡€è®¾æ–½å±‚ (Infrastructure)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç¼“å­˜ç®¡ç†      â”‚   æ€§èƒ½ç›‘æ§      â”‚   é”™è¯¯å¤„ç†      â”‚   å·¥å…·åº“    â”‚
â”‚                â”‚                â”‚                â”‚            â”‚
â”‚ â€¢ æ··åˆç¼“å­˜ç­–ç•¥   â”‚ â€¢ å®æ—¶ç›‘æ§      â”‚ â€¢ é‡è¯•æœºåˆ¶      â”‚ â€¢ å¸¸é‡é…ç½®  â”‚
â”‚ â€¢ å†…å­˜ç®¡ç†      â”‚ â€¢ æ€§èƒ½ä¼˜åŒ–      â”‚ â€¢ é™çº§ç­–ç•¥      â”‚ â€¢ å·¥å…·å‡½æ•°  â”‚
â”‚ â€¢ æŒä¹…åŒ–å­˜å‚¨    â”‚ â€¢ æŒ‡æ ‡æ”¶é›†      â”‚ â€¢ ç”¨æˆ·æç¤º      â”‚ â€¢ ç±»å‹å®šä¹‰  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© æ ¸å¿ƒæ¨¡å—è¯¦ç»†è®¾è®¡

### 1. æ•°æ®è¾“å…¥æ¨¡å— (Input Module)

#### 1.1 CameraManager - æ‘„åƒå¤´ç®¡ç†å™¨

**èŒè´£**:
- æ‘„åƒå¤´è®¾å¤‡æ£€æµ‹å’Œåˆå§‹åŒ–
- å‰åæ‘„åƒå¤´åˆ‡æ¢
- è§†é¢‘æµçŠ¶æ€ç®¡ç†
- æ‘„åƒå¤´æƒé™å¤„ç†

**æ ¸å¿ƒç‰¹æ€§**:
```typescript
interface CameraManagerInterface {
  // æ‘„åƒå¤´åˆå§‹åŒ–
  initialize(): Promise<void>;
  
  // è®¾ç½®æ‘„åƒå¤´
  setupCamera(facingMode: 'user' | 'environment'): Promise<HTMLVideoElement>;
  
  // æ‘„åƒå¤´åˆ‡æ¢
  switchCamera(): Promise<void>;
  
  // è·å–çŠ¶æ€
  getStatus(): CameraStatus;
  
  // èµ„æºæ¸…ç†
  cleanup(): Promise<void>;
}
```

**è®¾è®¡æ¨¡å¼**: å•ä¾‹æ¨¡å¼ + çŠ¶æ€æœºæ¨¡å¼

#### 1.2 å¤šè¾“å…¥æºæ”¯æŒæ¶æ„

```typescript
// è¾“å…¥æºæŠ½è±¡æ¥å£
interface InputSource {
  type: 'camera' | 'video' | 'image' | 'stream';
  initialize(): Promise<void>;
  getFrame(): Promise<ImageData | HTMLVideoElement>;
  cleanup(): void;
}

// å…·ä½“å®ç°
class CameraInputSource implements InputSource {
  type = 'camera';
  // å®ç°æ‘„åƒå¤´è¾“å…¥é€»è¾‘
}

class VideoFileInputSource implements InputSource {
  type = 'video';
  // å®ç°è§†é¢‘æ–‡ä»¶è¾“å…¥é€»è¾‘
}

class OnlineStreamInputSource implements InputSource {
  type = 'stream';
  // å®ç°åœ¨çº¿è§†é¢‘æµè¾“å…¥é€»è¾‘
}
```

### 2. å§¿æ€æ¨ç†æ¨¡å— (Inference Module)

#### 2.1 PoseEstimator - å§¿æ€ä¼°è®¡å™¨æ ¸å¿ƒ

**èŒè´£**:
- TensorFlow.js æ¨¡å‹ç®¡ç†
- å§¿æ€æ¨ç†æ‰§è¡Œ
- ç»“æœåå¤„ç†
- æ€§èƒ½ä¼˜åŒ–

**æ¶æ„è®¾è®¡**:
```typescript
class PoseEstimator {
  private detector: poseDetection.PoseDetector;
  private filterManager: OneEuroFilterManager;
  private performanceOptimizer: PerformanceOptimizer;
  
  // æ¨¡å‹åŠ è½½ç­–ç•¥
  async loadModel(modelType: 'MoveNet' | 'PoseNet'): Promise<void> {
    // æ™ºèƒ½ç¼“å­˜ + é¢„åŠ è½½ç­–ç•¥
  }
  
  // æ¨ç†æ‰§è¡Œ
  async estimatePoses(input: tf.Tensor3D): Promise<Pose[]> {
    // æ¨ç† + æ»¤æ³¢ + ä¼˜åŒ–
  }
}
```

#### 2.2 æ¨¡å‹ç®¡ç†ç­–ç•¥

**å¤šæ¨¡å‹æ”¯æŒ**:
- **MoveNet Lightning**: é«˜é€Ÿåº¦ï¼Œé€‚åˆå®æ—¶åº”ç”¨
- **MoveNet Thunder**: é«˜ç²¾åº¦ï¼Œé€‚åˆåˆ†æåº”ç”¨
- **PoseNet MobileNet**: å…¼å®¹æ€§å¥½ï¼Œé€‚åˆä½ç«¯è®¾å¤‡

**æ™ºèƒ½æ¨¡å‹é€‰æ‹©**:
```typescript
class ModelSelector {
  selectOptimalModel(context: {
    deviceTier: 'low' | 'medium' | 'high';
    useCase: 'realtime' | 'analysis' | 'recording';
    networkCondition: 'slow' | 'fast';
  }): ModelConfig {
    // åŸºäºä¸Šä¸‹æ–‡çš„æ™ºèƒ½é€‰æ‹©é€»è¾‘
  }
}
```

### 3. åˆ†æè®¡ç®—æ¨¡å— (Analysis Module)

#### 3.1 è¿åŠ¨åˆ†æå¼•æ“

**æ ¸å¿ƒåŠŸèƒ½**:
- **åŠ¨ä½œè¯†åˆ«**: è¯†åˆ«æ·±è¹²ã€ä¿¯å§æ’‘ã€è·‘æ­¥ç­‰åŠ¨ä½œ
- **é‡å¤è®¡æ•°**: åŸºäºå…³é”®ç‚¹è½¨è¿¹çš„æ™ºèƒ½è®¡æ•°
- **è´¨é‡è¯„ä¼°**: åŠ¨ä½œæ ‡å‡†æ€§è¯„åˆ†
- **è·‘å§¿åˆ†æ**: æ­¥é¢‘ã€è§¦åœ°æ—¶é—´ã€å‚ç›´æŒ¯å¹…ç­‰æŒ‡æ ‡

**æ¶æ„è®¾è®¡**:
```typescript
// åˆ†æå¼•æ“æ¥å£
interface AnalysisEngine {
  analyze(poses: Pose[], timestamp: number): AnalysisResult;
}

// å…·ä½“åˆ†æå™¨å®ç°
class ExerciseAnalyzer implements AnalysisEngine {
  // å¥èº«åŠ¨ä½œåˆ†æ
}

class RunningAnalyzer implements AnalysisEngine {
  // è·‘å§¿åˆ†æ
}

class PostureAnalyzer implements AnalysisEngine {
  // å§¿æ€è¯„ä¼°
}
```

#### 3.2 One Euro Filter æ»¤æ³¢ç³»ç»Ÿ

**è®¾è®¡ç›®æ ‡**: æ¶ˆé™¤å…³é”®ç‚¹æŠ–åŠ¨ï¼Œæä¾›å¹³æ»‘çš„å§¿æ€è·Ÿè¸ª

**æ ¸å¿ƒç‰¹æ€§**:
```typescript
class OneEuroFilterManager {
  private filters: Map<number, OneEuroFilter>;
  private adaptiveParams: AdaptiveFilterParams;
  
  // æ™ºèƒ½å‚æ•°è°ƒæ•´
  updateParameters(scenario: 'smooth' | 'responsive' | 'balanced'): void;
  
  // å…³é”®ç‚¹æ»¤æ³¢
  filterKeypoints(keypoints: Keypoint[]): Keypoint[];
}
```

### 4. æ¸²æŸ“æ¨¡å— (Rendering Module)

#### 4.1 å¤šçº¿ç¨‹æ¸²æŸ“æ¶æ„

**ä¸»çº¿ç¨‹ + Web Worker è®¾è®¡**:
```typescript
// ä¸»çº¿ç¨‹ï¼šUIäº¤äº’ + æ•°æ®åè°ƒ
class MainThreadRenderer {
  private offscreenManager: OffscreenRenderManager;
  
  render(poses: Pose[], canvas: HTMLCanvasElement): void {
    if (this.offscreenManager.isSupported) {
      // ä½¿ç”¨ OffscreenCanvas æ¸²æŸ“
      this.offscreenManager.render(poses);
    } else {
      // é™çº§åˆ°ä¸»çº¿ç¨‹æ¸²æŸ“
      this.renderOnMainThread(poses, canvas);
    }
  }
}

// Workerçº¿ç¨‹ï¼šé«˜æ€§èƒ½æ¸²æŸ“
class RenderWorker {
  // åœ¨ Worker ä¸­æ‰§è¡Œå¤æ‚çš„æ¸²æŸ“è®¡ç®—
}
```

#### 4.2 å¯è§†åŒ–ç»„ä»¶è®¾è®¡

**æ¸²æŸ“ç»„ä»¶**:
- **SkeletonRenderer**: éª¨æ¶è¿çº¿æ¸²æŸ“
- **KeypointRenderer**: å…³é”®ç‚¹æ ‡è®°æ¸²æŸ“
- **ConfidenceRenderer**: ç½®ä¿¡åº¦å¯è§†åŒ–
- **AnalysisOverlay**: åˆ†æç»“æœå åŠ æ˜¾ç¤º

### 5. ç¼“å­˜ç®¡ç†æ¨¡å— (Cache Module)

#### 5.1 æ··åˆç¼“å­˜ç­–ç•¥

**ä¸‰å±‚ç¼“å­˜æ¶æ„**:
```typescript
class HybridCacheManager {
  private L1_memoryCache: Map<string, any>;           // å†…å­˜ç¼“å­˜
  private L2_indexedDBCache: IndexedDBCacheManager;   // æŒä¹…åŒ–ç¼“å­˜
  private L3_cacheAPICache: CacheAPIManager;          // ç½‘ç»œç¼“å­˜
  
  async getOrCreateModel(modelType: string, createFn: Function): Promise<Model> {
    // L1 -> L2 -> L3 -> ç½‘ç»œåŠ è½½çš„æ™ºèƒ½ç¼“å­˜ç­–ç•¥
  }
}
```

**ç¼“å­˜ç­–ç•¥ä¼˜å…ˆçº§**:
1. **å†…å­˜ç¼“å­˜**: æœ€å¿«è®¿é—®ï¼Œå®¹é‡æœ‰é™
2. **IndexedDB**: æŒä¹…åŒ–å­˜å‚¨ï¼Œå®¹é‡è¾ƒå¤§
3. **Cache API**: ç½‘ç»œå±‚ç¼“å­˜ï¼Œç¦»çº¿æ”¯æŒ
4. **ç½‘ç»œåŠ è½½**: æœ€åçš„é™çº§é€‰é¡¹

---

## ğŸ”„ æ•°æ®æµè®¾è®¡

### ä¸»è¦æ•°æ®æµè·¯å¾„

```
è¾“å…¥æº â†’ å¸§æ•è· â†’ é¢„å¤„ç† â†’ æ¨¡å‹æ¨ç† â†’ åå¤„ç† â†’ åˆ†æè®¡ç®— â†’ æ¸²æŸ“æ˜¾ç¤º
   â†“        â†“        â†“        â†“        â†“        â†“        â†“
æ‘„åƒå¤´   è§†é¢‘å¸§   å¼ é‡è½¬æ¢   å§¿æ€æ£€æµ‹   æ»¤æ³¢å¤„ç†   è¿åŠ¨åˆ†æ   å¯è§†åŒ–
è§†é¢‘æ–‡ä»¶  å›¾åƒå¸§   å°ºå¯¸è°ƒæ•´   å…³é”®ç‚¹    ç½®ä¿¡åº¦    é‡å¤è®¡æ•°   UIæ›´æ–°
å›¾ç‰‡     æµæ•°æ®   æ ¼å¼è½¬æ¢   è¿æ¥çº¿    åæ ‡å˜æ¢   è´¨é‡è¯„ä¼°   çŠ¶æ€åé¦ˆ
```

### å¼‚æ­¥æ•°æ®å¤„ç†ç®¡é“

```typescript
class DataPipeline {
  async process(inputFrame: ImageData): Promise<RenderData> {
    // 1. é¢„å¤„ç†
    const tensor = await this.preprocessFrame(inputFrame);
    
    // 2. æ¨ç†
    const poses = await this.poseEstimator.estimate(tensor);
    
    // 3. åå¤„ç†
    const filteredPoses = this.filterManager.filter(poses);
    
    // 4. åˆ†æ
    const analysis = this.analysisEngine.analyze(filteredPoses);
    
    // 5. æ¸²æŸ“æ•°æ®å‡†å¤‡
    return this.prepareRenderData(filteredPoses, analysis);
  }
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ™ºèƒ½å¸§ç‡æ§åˆ¶

**è‡ªé€‚åº”å¸§ç‡ç³»ç»Ÿ**:
```typescript
class AdaptiveFrameController {
  private targetFPS: number = 30;
  private performanceMonitor: PerformanceMonitor;
  
  adjustFrameRate(metrics: PerformanceMetrics): void {
    if (metrics.inferenceTime > 33) { // è¶…è¿‡30fpsé˜ˆå€¼
      this.targetFPS = Math.max(this.targetFPS - 5, 15);
    } else if (metrics.inferenceTime < 16) { // ä½äº60fpsé˜ˆå€¼
      this.targetFPS = Math.min(this.targetFPS + 5, 60);
    }
  }
}
```

### 2. å†…å­˜ç®¡ç†ä¼˜åŒ–

**TensorFlow.js å†…å­˜ç®¡ç†**:
```typescript
class MemoryManager {
  async processWithMemoryManagement<T>(fn: () => Promise<T>): Promise<T> {
    return tf.tidy(() => {
      return fn();
    });
  }
  
  periodicCleanup(): void {
    // å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„å¼ é‡
    tf.disposeVariables();
  }
}
```

### 3. æ¸²æŸ“ä¼˜åŒ–

**OffscreenCanvas + Web Workers**:
- ä¸»çº¿ç¨‹ä¸“æ³¨äº UI äº¤äº’
- Worker çº¿ç¨‹å¤„ç†å¤æ‚æ¸²æŸ“è®¡ç®—
- å‡å°‘ä¸»çº¿ç¨‹é˜»å¡ï¼Œæå‡å“åº”æ€§

---

## ğŸ›¡ï¸ é”™è¯¯å¤„ç†ä¸å®¹é”™è®¾è®¡

### é”™è¯¯å¤„ç†å±‚æ¬¡

```typescript
// 1. å…¨å±€é”™è¯¯å¤„ç†å™¨
class GlobalErrorHandler {
  handleError(error: Error, context: string): void {
    // é”™è¯¯åˆ†ç±»ã€æ—¥å¿—è®°å½•ã€ç”¨æˆ·æç¤º
  }
}

// 2. æ¨¡å—çº§é”™è¯¯å¤„ç†
class ModuleErrorHandler {
  async withRetry<T>(fn: () => Promise<T>, maxRetries: number = 3): Promise<T> {
    // é‡è¯•æœºåˆ¶
  }
  
  async withFallback<T>(primary: () => Promise<T>, fallback: () => Promise<T>): Promise<T> {
    // é™çº§ç­–ç•¥
  }
}

// 3. ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
class UserErrorHandler {
  showFriendlyError(error: Error): void {
    // å°†æŠ€æœ¯é”™è¯¯è½¬æ¢ä¸ºç”¨æˆ·å¯ç†è§£çš„æç¤º
  }
}
```

### é™çº§ç­–ç•¥

1. **æ¨¡å‹é™çº§**: Thunder â†’ Lightning â†’ PoseNet
2. **æ¸²æŸ“é™çº§**: WebGL â†’ Canvas 2D
3. **åŠŸèƒ½é™çº§**: å®æ—¶åˆ†æ â†’ åŸºç¡€æ£€æµ‹
4. **ç¼“å­˜é™çº§**: å¤šå±‚ç¼“å­˜ â†’ å†…å­˜ç¼“å­˜ â†’ æ— ç¼“å­˜

---

## ğŸ”§ æŠ€æœ¯é€‰å‹åˆ†æ

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯ | é€‰æ‹©ç†ç”± | æ›¿ä»£æ–¹æ¡ˆ | ä¼˜ç¼ºç‚¹åˆ†æ |
|------|----------|----------|------------|
| **TensorFlow.js** | æµè§ˆå™¨ç«¯AIæ¨ç†æ ‡å‡† | MediaPipe, ONNX.js | âœ… ç”Ÿæ€å®Œå–„ âŒ åŒ…ä½“ç§¯å¤§ |
| **TypeScript** | ç±»å‹å®‰å…¨ï¼Œå¼€å‘æ•ˆç‡ | çº¯JavaScript | âœ… ç±»å‹æ£€æŸ¥ âŒ ç¼–è¯‘æ­¥éª¤ |
| **Web Workers** | å¤šçº¿ç¨‹å¤„ç† | ä¸»çº¿ç¨‹å¤„ç† | âœ… æ€§èƒ½æå‡ âŒ å…¼å®¹æ€§ |
| **IndexedDB** | å®¢æˆ·ç«¯å­˜å‚¨ | LocalStorage | âœ… å®¹é‡å¤§ âŒ APIå¤æ‚ |
| **Canvas API** | 2Dæ¸²æŸ“ | WebGL, SVG | âœ… å…¼å®¹æ€§å¥½ âŒ æ€§èƒ½é™åˆ¶ |

### æ¶æ„æ¨¡å¼é€‰æ‹©

**æ¨¡å—åŒ–è®¾è®¡**:
- **ä¼˜ç‚¹**: èŒè´£æ¸…æ™°ã€æ˜“äºæµ‹è¯•ã€å¯ç»´æŠ¤æ€§é«˜
- **å®ç°**: ES6 æ¨¡å— + ä¾èµ–æ³¨å…¥

**è§‚å¯Ÿè€…æ¨¡å¼**:
- **åº”ç”¨**: æ€§èƒ½ç›‘æ§ã€çŠ¶æ€å˜åŒ–é€šçŸ¥
- **å®ç°**: EventEmitter + è‡ªå®šä¹‰äº‹ä»¶

**ç­–ç•¥æ¨¡å¼**:
- **åº”ç”¨**: ç¼“å­˜ç­–ç•¥ã€æ¸²æŸ“ç­–ç•¥ã€åˆ†æç®—æ³•
- **å®ç°**: æ¥å£æŠ½è±¡ + å…·ä½“å®ç°ç±»

---

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### 1. æ–°è¾“å…¥æºæ‰©å±•

```typescript
// æ‰©å±•æ–°çš„è¾“å…¥æºåªéœ€å®ç° InputSource æ¥å£
class WebRTCInputSource implements InputSource {
  type = 'webrtc';
  // å®ç° WebRTC è§†é¢‘æµè¾“å…¥
}

class ScreenCaptureInputSource implements InputSource {
  type = 'screen';
  // å®ç°å±å¹•æ•è·è¾“å…¥
}
```

### 2. æ–°åˆ†æç®—æ³•æ‰©å±•

```typescript
// æ‰©å±•æ–°çš„åˆ†æç®—æ³•
class YogaPoseAnalyzer implements AnalysisEngine {
  analyze(poses: Pose[]): YogaAnalysisResult {
    // ç‘œä¼½å§¿åŠ¿åˆ†æé€»è¾‘
  }
}

class DanceAnalyzer implements AnalysisEngine {
  analyze(poses: Pose[]): DanceAnalysisResult {
    // èˆè¹ˆåŠ¨ä½œåˆ†æé€»è¾‘
  }
}
```

### 3. æ–°æ¸²æŸ“æ–¹å¼æ‰©å±•

```typescript
// æ‰©å±•æ–°çš„æ¸²æŸ“å™¨
class AR3DRenderer implements Renderer {
  render(poses: Pose[], context: ARContext): void {
    // AR 3D æ¸²æŸ“é€»è¾‘
  }
}

class VRRenderer implements Renderer {
  render(poses: Pose[], context: VRContext): void {
    // VR æ¸²æŸ“é€»è¾‘
  }
}
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡ä¸ç›‘æ§

### å…³é”®æ€§èƒ½æŒ‡æ ‡ (KPIs)

```typescript
interface PerformanceMetrics {
  // æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡
  frameRate: number;           // å¸§ç‡ (fps)
  inferenceTime: number;       // æ¨ç†æ—¶é—´ (ms)
  renderTime: number;          // æ¸²æŸ“æ—¶é—´ (ms)
  memoryUsage: number;         // å†…å­˜ä½¿ç”¨ (MB)
  
  // ç”¨æˆ·ä½“éªŒæŒ‡æ ‡
  timeToFirstFrame: number;    // é¦–å¸§æ—¶é—´ (ms)
  timeToInteractive: number;   // å¯äº¤äº’æ—¶é—´ (ms)
  
  // ç³»ç»Ÿç¨³å®šæ€§æŒ‡æ ‡
  errorRate: number;           // é”™è¯¯ç‡ (%)
  cacheHitRate: number;        // ç¼“å­˜å‘½ä¸­ç‡ (%)
  frameDropRate: number;       // ä¸¢å¸§ç‡ (%)
}
```

### æ€§èƒ½ç›‘æ§ä»ªè¡¨æ¿

```typescript
class PerformanceDashboard {
  render(): DashboardData {
    return {
      realTimeMetrics: this.getRealTimeMetrics(),
      historicalTrends: this.getHistoricalTrends(),
      systemHealth: this.getSystemHealth(),
      optimizationSuggestions: this.getOptimizationSuggestions()
    };
  }
}
```

---

## ğŸ”® æœªæ¥å‘å±•æ–¹å‘

### çŸ­æœŸç›®æ ‡ (1-3ä¸ªæœˆ)

1. **WebAssembly é›†æˆ**: æå‡è®¡ç®—å¯†é›†å‹æ“ä½œæ€§èƒ½
2. **Service Worker ç¼“å­˜**: å®ç°ç¦»çº¿åŠŸèƒ½æ”¯æŒ
3. **Progressive Web App**: æä¾›åŸç”Ÿåº”ç”¨ä½“éªŒ
4. **å¤šäººåä½œ**: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶åˆ†æ

### ä¸­æœŸç›®æ ‡ (3-6ä¸ªæœˆ)

1. **è¾¹ç¼˜è®¡ç®—**: é›†æˆ WebNN API è¿›è¡Œç¡¬ä»¶åŠ é€Ÿ
2. **äº‘ç«¯åä½œ**: æ¨¡å‹ç‰ˆæœ¬ç®¡ç†å’Œå¢é‡æ›´æ–°
3. **AI ä¼˜åŒ–**: ä½¿ç”¨å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–å‚æ•°è°ƒæ•´
4. **è·¨å¹³å°**: æ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯

### é•¿æœŸæ„¿æ™¯ (6-12ä¸ªæœˆ)

1. **å®æ—¶åä½œ**: å¤šç”¨æˆ·å®æ—¶å§¿æ€åˆ†æå’Œæ¯”è¾ƒ
2. **ä¸ªæ€§åŒ–**: åŸºäºç”¨æˆ·æ•°æ®çš„ä¸ªæ€§åŒ–åˆ†æ
3. **ç”Ÿæ€ç³»ç»Ÿ**: æ’ä»¶åŒ–æ¶æ„æ”¯æŒç¬¬ä¸‰æ–¹æ‰©å±•
4. **å•†ä¸šåŒ–**: é¢å‘å¥èº«æˆ¿ã€åŒ»ç–—æœºæ„çš„è§£å†³æ–¹æ¡ˆ

---

## ğŸ“ æ€»ç»“

æœ¬æ¶æ„è®¾è®¡æ–‡æ¡£è¯¦ç»†æè¿°äº† TensorFlow.js å¥èº«å§¿æ€åˆ†æç³»ç»Ÿçš„å®Œæ•´æŠ€æœ¯æ¶æ„ã€‚è¯¥æ¶æ„å…·æœ‰ä»¥ä¸‹æ ¸å¿ƒä¼˜åŠ¿ï¼š

### âœ… æ¶æ„ä¼˜åŠ¿

1. **é«˜æ€§èƒ½**: å¤šçº¿ç¨‹æ¸²æŸ“ + æ™ºèƒ½ç¼“å­˜ + è‡ªé€‚åº”ä¼˜åŒ–
2. **é«˜å¯ç”¨**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§ç­–ç•¥
3. **é«˜æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡æ”¯æŒåŠŸèƒ½æ‰©å±•
4. **é«˜è´¨é‡**: TypeScript + æµ‹è¯•è¦†ç›–ä¿è¯ä»£ç è´¨é‡
5. **ç”¨æˆ·å‹å¥½**: æµç•…çš„äº¤äº’å’Œç›´è§‚çš„çŠ¶æ€åé¦ˆ

### ğŸ¯ é€‚ç”¨åœºæ™¯

- **å¥èº«åº”ç”¨**: åŠ¨ä½œè¯†åˆ«ã€é‡å¤è®¡æ•°ã€å§¿åŠ¿çº æ­£
- **è¿åŠ¨åˆ†æ**: è·‘å§¿åˆ†æã€æŠ€æœ¯åŠ¨ä½œè¯„ä¼°
- **åŒ»ç–—åº·å¤**: åº·å¤è®­ç»ƒç›‘æ§ã€å§¿æ€è¯„ä¼°
- **æ•™è‚²åŸ¹è®­**: ä½“è‚²æ•™å­¦ã€åŠ¨ä½œç¤ºèŒƒ
- **å¨±ä¹äº’åŠ¨**: ä½“æ„Ÿæ¸¸æˆã€AR/VR åº”ç”¨

### ğŸš€ æŠ€æœ¯åˆ›æ–°ç‚¹

1. **æ™ºèƒ½æ··åˆç¼“å­˜**: æ ¹æ®æµè§ˆå™¨èƒ½åŠ›è‡ªåŠ¨é€‰æ‹©æœ€ä½³ç¼“å­˜ç­–ç•¥
2. **è‡ªé€‚åº”æ€§èƒ½ä¼˜åŒ–**: åŸºäºå®æ—¶æ€§èƒ½æŒ‡æ ‡åŠ¨æ€è°ƒæ•´ç³»ç»Ÿå‚æ•°
3. **å¤šçº¿ç¨‹æ¸²æŸ“æ¶æ„**: OffscreenCanvas + Web Workers æå‡æ¸²æŸ“æ€§èƒ½
4. **åœºæ™¯åŒ–æ»¤æ³¢ç­–ç•¥**: é’ˆå¯¹ä¸åŒåº”ç”¨åœºæ™¯ä¼˜åŒ– One Euro Filter å‚æ•°
5. **æ¸è¿›å¼åŠŸèƒ½é™çº§**: ç¡®ä¿åœ¨å„ç§è®¾å¤‡å’Œç½‘ç»œç¯å¢ƒä¸‹çš„å¯ç”¨æ€§

è¿™ä¸ªæ¶æ„ä¸ºæ„å»ºé«˜è´¨é‡ã€é«˜æ€§èƒ½ã€é«˜å¯æ‰©å±•æ€§çš„å¥èº«å§¿æ€åˆ†æåº”ç”¨æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚